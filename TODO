[x] Substitue identites
[x] Build ILP program
[x] Extract core variables
[x] Filter non thefunc expressions
